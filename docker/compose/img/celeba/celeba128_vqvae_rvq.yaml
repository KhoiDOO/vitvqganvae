services:
  celeba128-vqvae-rvq:
    build:
      context: ../../..
      dockerfile: docker/vqvae/img/celeb128/celeba128_vqvae_rvq.dockerfile
    image: vitvqganvae:celeba128_vqvae_rvq
    shm_size: '32g'
    volumes:
      - ./.cache:/vitvqganvae/.cache
      - ./outputs:/vitvqganvae/outputs
    environment:
      - WANDB_API_KEY=${WANDB_API_KEY}
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: all
              capabilities: [gpu]

networks:
  default:
    external: true
    name: vitvqganvae_network
